plugins {
  id 'java-library'
  id 'scala'
  id 'com.github.maiflai.scalatest'
  id 'maven-publish'
  id 'com.jfrog.bintray'
  id 'com.google.cloud.tools.jib'
  id 'org.podval.tools.cloudrun'
}

description = 'Archive Collector'

configureLibrary(['Scala', 'Jewish', 'TEI'])
configureService()

dependencies {
  implementation project(':store')
  implementation project(':util')

  implementation "com.vladsch.flexmark:flexmark:$flexmarkVersion"
  implementation "com.vladsch.flexmark:flexmark-ext-toc:$flexmarkVersion"
//  implementation "com.vladsch.flexmark:flexmark-util-ast:$flexmarkVersion"
//  implementation "com.vladsch.flexmark:flexmark-util-data:$flexmarkVersion"
  implementation "ch.qos.logback:logback-classic:$logbackVersion"

  implementation "com.google.cloud:google-cloud-storage:$googleCloudStorageVersion" // https://github.com/googleapis/java-storage
//  implementation "com.google.auth:google-auth-library-oauth2-http:$googleOauth2Version"
//  implementation "com.google.api-client:google-api-client:$googleApiClientVersion"

  testImplementation "org.podval.tools:org.podval.tools.run:$podvalRunVersion"
}

// TODO IntelliJ Idea does not make JIB builder available for
//   Cloud Code | Cloud Run | Run Locally Run configuration...

jib.container.mainClass = 'org.opentorah.collector.Service'
cloudRun.region = 'us-east4'
deploy.dependsOn(cloudRunDeploy)
