buildscript {
  repositories {
    jcenter()
    mavenCentral()
    mavenLocal()
    // TODO remove once personal Bintray repository gets linked into JCenter
    maven {
      url 'https://dl.bintray.com/dubinsky/org.podval.docbook'
    }
  }

  dependencies {
    classpath 'org.podval.docbook:org.podval.docbook-gradle-plugin:+'
  }
}

apply plugin: 'org.podval.docbook-gradle-plugin'

dependencies {
  compile lib.scalaXml, project(':library')
}

def docBookData = file("${buildDir}/data")

docbook {
  inputFileName = "calendar"

  dataDirectory = docBookData

  xslParameters = [
    "title.font.family": "Noto Sans, Noto Sans Hebrew",
    "body.font.family": "Noto Sans, Noto Sans Hebrew",
//    "dingbat.font.family": "???", // The font family for copyright, quotes, and other symbols
//    "sans.font.family": "???",
//    "monospace.font.family": "monospace",
//    "symbol.font.family": "???" // TODO configure with catch-all symbol font(s)
    "body.font.master": "12",
//    "footnote.font.size": "10",
    "html.stylesheet": "css/docbook.css"
  ]

  // TODO define entities:
  // version: project.version.toString
  // tables-directory: ${buildDir}/tables
  // date: LocalDate.now().format(DateTimeFormatter.ofPattern("d MMM yyyy"))
}

// Generated content that needs to be included in DocBook is produced by executing the generating code.
task buildTables(type: JavaExec, dependsOn: [classes]) {
  classpath = sourceSets.main.runtimeClasspath
  main = "org.podval.calendar.paper.Tables"
  args = [ "$docBookData" ]
}
prepareDocBookData.dependsOn.add(buildTables)
